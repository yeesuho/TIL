2025.04.27

### 예외처리
프로그램이 실행되는 동안 문제가 발생하면 프로그램이 자동으로 중단되는데 이럴 경우 프로그램이 대처할 수 있도록 처리하는 것이 예외처리라고 합니다

예외가 발생하는 이유에는 여러가지가 있지만<br>
일반적으로 잘못된 코드를 작성했거나 사용자가 개발자가 원하지 않는 방향으로 프로그램을 사용했을 때 발생합니다

>※ 프로그램 실행 중 발생하는 오류 => 예외(Exception)<br>
>※ 프로그래밍 언어의 문법적인 오류 => 에러(Error)

## throw
"예외"란 무언가 예외적인 상황이나 에러가 발생했음을 가리키는 신호입니다<br>
예외를 "발생시키다(throw)"라는 것은 그러한 에러나 예외 상황을 알린다는 뜻입니다<br>
예외를 "잡아내다(catch)"라는 것은 예외를 처리한다는 뜻인데 즉 예외를 회복하기 위해 무언가 필요하거나 적절한 행동을 취한다는 뜻이죠

정리하면 예외를 강제로 발생시켜야 할 경우가 생길 때는 `"throw"`를 사용하고, 그 예외를 잡아내는 데에는 `"try / catch / finally"`를 사용합니다
```java
function factorial(x) { 
    // 만약 전달인자가 유효하지 않으면 예외를 발생
    if (x < 0) { 
        throw new Error('x는 음수가 아니어야 합니다.') 
    } // 유효하다면, 값을 계산하여 정상적으로 반환
    for (var f = 1; x > 1; f *= x, x--) /* 비어 있음 */ 
    return f; 
}
```

예외가 발생하면 인터프리터는 정상적인 프로그램 실행을 즉시 중단하고 가장 가까운 예외 처리기로 넘어갑니다

예외를 발생시켰던 코드 블록이 catch절과 연결되어 있지 않으면 인터프리터는 바로 상위 단계를 감싸고 있는 코드 블록에 연결되어 있는지를 확인합니다 (예외 처리기를 찾을 때까지 반복)

만일 예외를 처리할 `try / catch / finally`가 없는 함수 안에서 예외가 발생하면 해당 함수를 호출했던 블록으로 그 예외가 전파되어 올라갑니다

즉 호출 스택(call stack)을 따라서 예외가 전파되어 올라가고 그래도 아무런 예외 처리기도 찾을 수 없으면 이 예외는 에러로 취급되어 사용자에게 보고되어집니다

### ※ 예외를 강제로 발생시키는 이유
개체를 잘못 사용하는 사용자에게 예외를 강제로 발생시켜서 사용자에게 주의를 줄 수 있습니다

<br>

## try/catch/finally
1) **try:** 예외가 발생할지 발생하지 않을지 모르는 코드 블록 정의

2) **catch:** 
try 블록 내부에서 예외가 발생할 경우 호출되는 문장 블록

3) **finally:** 
try 블록에서 일어난 일에 관계없이 항상 실행이 보장되는 마지막 실행 코드

> ※ `catch나 finally` 블록은 생략할 수 있으나<br> `try` 블록은 `catch나 finally` 중 적어도 하나 이상의 블록과 함께 사용되어야 합니다

> ※ `try, catch, finally` 블록은 모두 중괄호로 시작하여 중괄호로 끝납니다 <br>이 중괄호들은 필수로 요구되는 문법의 일부로서 생략할 수 없습니다 (해당절에 단 하나의 문장만 있더라도)

위의 사항을 정리하자면 아래와 같다
```java
try { 
    /** 
    * 정상이라면 이 코드는 아무런 문제없이 블록의 시작부터 끝까지 실행된다 
    * 하지만 경우에 따라 예외가 발생할 수 있다 
    * 예외는 throw 문에 의해 직접적으로 발생할 수도 있고 
    * 또는 예외를 발생시키는 메서드의 호출에 의해 발생할 수도 있다 
    */ 
} catch (e) { 
    /** 
    * 이 블록 내부의 문장들은 오직 try 블록에서 예외가 발생할 경우에만 실행된다
    * 이 문장들에선 지역 변수 e를 사용하여 Error 객체 또는 앞에서 던진 다른 값을 참조할 수 있다
    * 이 블록에서는 어떻게든 그 예외를 처리할 수도 있고
    * 그냥 아무것도 하지 않고 예외를 무시할 수도 있고
    * 아니면 throw 를 사용해서 예외를 다시 발생시킬 수도 있다
    */ 
} finally { 
    /** 
    * 이 블록에는 try 블록에서 일어난 일에 관계없이 무조건 실행될 코드가 위치한다
    * 이 코드는 try 블록이 어떻게든 종료되면 실행된다
    * 
    * try 블록이 종료되는 상황은 다음과 같다
    * 1) 정상적으로 블록의 끝에 도달했을 때 
    * 2) break, continue 또는 return 문에 의해서 
    * 3) 예외가 발생했지만 catch 절에서 처리했을 때 
    * 4) 예외가 발생했고 그것이 잡히지 않은 채 퍼져나갈 때 
    */ 
}
```

### 사용법 예시
```java
public class TryCatchFinallyExample {
    public static void main(String[] args) {
        int a = 10;
        int b = 0;

        try {
            // 예외가 발생할 수 있는 코드
            int result = a / b; // b가 0이라서 에러 발생 (ArithmeticException)
            System.out.println("결과: " + result);
        } catch (ArithmeticException e) {
            // 에러가 발생했을 때 실행
            System.out.println("0으로 나눌 수 없습니다.");
            System.out.println("에러 메시지: " + e.getMessage());
        } finally {
            // 예외 발생 여부 상관없이 항상 실행
            System.out.println("프로그램 종료");
        }
    }
}
```
### 실행 결과
```
0으로 나눌 수 없습니다.
에러 메시지: / by zero
프로그램 종료
```
- try 블록에서 a / b 계산을 시도

- b가 0이니까 ArithmeticException 발생

- catch 블록이 이 에러를 잡아서, 에러 메시지를 출력

- 마지막으로 finally 블록이 무조건 실행돼서 "프로그램 종료"를 출력